--// Servi√ßos
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

--// ScreenGui
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = CoreGui
ScreenGui.ResetOnSpawn = false
ScreenGui.Name = "teste"

--// Menu Principal
local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.AnchorPoint = Vector2.new(0.5,0.5)
MainFrame.Position = UDim2.new(0.5,0,0.5,0)
MainFrame.Size = UDim2.new(0,650,0,400)
MainFrame.BackgroundColor3 = Color3.fromRGB(20,20,20)
MainFrame.BorderSizePixel = 0
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0,8)

local Stroke = Instance.new("UIStroke", MainFrame)
Stroke.Thickness = 1
Stroke.Color = Color3.fromRGB(60,60,60)

--// TopBar
local TopBar = Instance.new("Frame", MainFrame)
TopBar.Size = UDim2.new(1,0,0,35)
TopBar.BackgroundColor3 = Color3.fromRGB(15,15,15)
Instance.new("UICorner", TopBar).CornerRadius = UDim.new(0,8)

local Title = Instance.new("TextLabel", TopBar)
Title.Text = "AimGodz"
Title.Size = UDim2.new(1,-70,1,0)
Title.Position = UDim2.new(0,10,0,0)
Title.BackgroundTransparency = 1
Title.TextColor3 = Color3.fromRGB(255,255,255)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 14
Title.TextXAlignment = Enum.TextXAlignment.Left

-- Minimizar
local MinBtn = Instance.new("TextButton", TopBar)
MinBtn.Size = UDim2.new(0,35,0,35)
MinBtn.Position = UDim2.new(1,-70,0,0)
MinBtn.Text = "-"
MinBtn.BackgroundTransparency = 1
MinBtn.TextColor3 = Color3.fromRGB(200,200,200)
MinBtn.Font = Enum.Font.GothamBold
MinBtn.TextSize = 18

-- Fechar (X)
local CloseBtn = Instance.new("TextButton", TopBar)
CloseBtn.Size = UDim2.new(0,35,0,35)
CloseBtn.Position = UDim2.new(1,-35,0,0)
CloseBtn.Text = "X"
CloseBtn.BackgroundTransparency = 1
CloseBtn.TextColor3 = Color3.fromRGB(255,100,100)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.TextSize = 18
CloseBtn.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- Conte√∫do
local Content = Instance.new("Frame", MainFrame)
Content.Position = UDim2.new(0,150,0,35)
Content.Size = UDim2.new(1,-150,1,-35)
Content.BackgroundTransparency = 1

-- Tabs
local TabList = Instance.new("Frame", MainFrame)
TabList.Position = UDim2.new(0,0,0,35)
TabList.Size = UDim2.new(0,150,1,-35)
TabList.BackgroundColor3 = Color3.fromRGB(25,25,25)
Instance.new("UICorner", TabList).CornerRadius = UDim.new(0,8)

local TabLayout = Instance.new("UIListLayout", TabList)
TabLayout.SortOrder = Enum.SortOrder.LayoutOrder
TabLayout.Padding = UDim.new(0,5)

-- Criador de Tabs
local function CreateTab(Name)
    local Button = Instance.new("TextButton", TabList)
    Button.Size = UDim2.new(1,-10,0,30)
    Button.Text = Name
    Button.BackgroundColor3 = Color3.fromRGB(30,30,30)
    Button.TextColor3 = Color3.fromRGB(255,255,255)
    Button.Font = Enum.Font.GothamBold
    Button.TextSize = 13
    Button.BorderSizePixel = 0
    Instance.new("UICorner", Button).CornerRadius = UDim.new(0,6)

    local TabPage = Instance.new("ScrollingFrame", Content)
    TabPage.Size = UDim2.new(1,0,1,0)
    TabPage.BackgroundTransparency = 1
    TabPage.ScrollBarThickness = 4
    TabPage.Visible = false
    TabPage.AutomaticCanvasSize = Enum.AutomaticSize.Y

    local UIList = Instance.new("UIListLayout", TabPage)
    UIList.SortOrder = Enum.SortOrder.LayoutOrder
    UIList.Padding = UDim.new(0,5)

    Button.MouseButton1Click:Connect(function()
        for _,v in pairs(Content:GetChildren()) do
            if v:IsA("ScrollingFrame") then
                v.Visible = false
            end
        end
        TabPage.Visible = true
    end)

    return TabPage
end

--// Criar Tabs
local TabInicio = CreateTab("In√≠cio")
TabInicio.Visible = true
local TabCombate = CreateTab("Combate")
local TabVisual = CreateTab("Visual")
local TabConfig = CreateTab("Config")

--// Fun√ß√µes de Componentes

--// SISTEMA TAB IN√çCIO
local function CreateInfoLabel(Parent, Text)
    local Label = Instance.new("TextLabel", Parent)
    Label.Size = UDim2.new(1,-10,0,25)
    Label.BackgroundTransparency = 1
    Label.Text = Text
    Label.TextColor3 = Color3.fromRGB(255,255,255)
    Label.Font = Enum.Font.Gotham
    Label.TextSize = 12
    Label.TextXAlignment = Enum.TextXAlignment.Left
    return Label
end

-- T√≠tulo do Menu
local TituloInicio = Instance.new("TextLabel", TabInicio)
TituloInicio.Size = UDim2.new(1,-10,0,40)
TituloInicio.BackgroundTransparency = 1
TituloInicio.Text = "AimGodz"
TituloInicio.TextColor3 = Color3.fromRGB(0,255,140)
TituloInicio.Font = Enum.Font.GothamBold
TituloInicio.TextSize = 18
TituloInicio.TextXAlignment = Enum.TextXAlignment.Center

-- Informa√ß√µes do Desenvolvedor
CreateInfoLabel(TabInicio, "üßë‚Äçüíª Desenvolvedor: thziin_01")
CreateInfoLabel(TabInicio, "üéÆ Vers√£o: 2.0")

-- Informa√ß√µes do Jogador
local playerInfo = CreateInfoLabel(TabInicio, "üë§ Jogador: " .. LocalPlayer.Name)
local displayInfo = CreateInfoLabel(TabInicio, "üìõ Display: " .. LocalPlayer.DisplayName)
local userIdInfo = CreateInfoLabel(TabInicio, "üÜî User ID: " .. LocalPlayer.UserId)

-- Informa√ß√µes do Jogo
local gameName = "Carregando..."
local success, result = pcall(function()
    return game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name
end)
if success then
    gameName = result
else
    gameName = "N√£o identificado"
end

local gameInfo = CreateInfoLabel(TabInicio, "üéØ Jogo: " .. gameName)
local placeIdInfo = CreateInfoLabel(TabInicio, "üìç Place ID: " .. game.PlaceId)

-- Contador de Jogadores
local playerCountInfo = CreateInfoLabel(TabInicio, "üë• Jogadores no Servidor: " .. #Players:GetPlayers())

-- Atualizar contador de jogadores automaticamente
Players.PlayerAdded:Connect(function()
    playerCountInfo.Text = "üë• Jogadores no Servidor: " .. #Players:GetPlayers()
end)

Players.PlayerRemoving:Connect(function()
    playerCountInfo.Text = "üë• Jogadores no Servidor: " .. #Players:GetPlayers()
end)

-- Data e Hora
local timeInfo = CreateInfoLabel(TabInicio, "üïí Data/Hora: Carregando...")

-- Atualizar hora a cada segundo
spawn(function()
    while wait(1) do
        local currentTime = os.date("%d/%m/%Y %H:%M:%S")
        timeInfo.Text = "üïí Data/Hora: " .. currentTime
    end
end)

-- Status do Menu
CreateInfoLabel(TabInicio, "‚úÖ Status: Menu Carregado com Sucesso!")
CreateInfoLabel(TabInicio, "üîß Total de Fun√ß√µes: 20+")
CreateInfoLabel(TabInicio, "üì± Plataforma: " .. (UserInputService.TouchEnabled and "Mobile" or "PC"))

-- Espa√ßamento
local espaco = Instance.new("Frame", TabInicio)
espaco.Size = UDim2.new(1,0,0,10)
espaco.BackgroundTransparency = 1

-- Cr√©ditos Finais
local creditos = Instance.new("TextLabel", TabInicio)
creditos.Size = UDim2.new(1,-10,0,30)
creditos.BackgroundTransparency = 1
creditos.Text = "by thziin_01"
creditos.TextColor3 = Color3.fromRGB(255,255,255)
creditos.Font = Enum.Font.GothamBold
creditos.TextSize = 14
creditos.TextXAlignment = Enum.TextXAlignment.Center

-- üîò Toggle moderno (Switch)
local function AddToggle(Parent, Text, Callback)
    local Frame = Instance.new("Frame", Parent)
    Frame.Size = UDim2.new(1,-10,0,35)
    Frame.BackgroundColor3 = Color3.fromRGB(30,30,30)
    Instance.new("UICorner", Frame).CornerRadius = UDim.new(0,6)

    local Label = Instance.new("TextLabel", Frame)
    Label.Text = Text
    Label.Size = UDim2.new(1,-60,1,0)
    Label.Position = UDim2.new(0,10,0,0)
    Label.BackgroundTransparency = 1
    Label.TextColor3 = Color3.fromRGB(255,255,255)
    Label.Font = Enum.Font.Gotham
    Label.TextSize = 13
    Label.TextXAlignment = Enum.TextXAlignment.Left

    local Switch = Instance.new("Frame", Frame)
    Switch.Size = UDim2.new(0,40,0,20)
    Switch.Position = UDim2.new(1,-50,0.5,-10)
    Switch.BackgroundColor3 = Color3.fromRGB(60,60,60)
    Instance.new("UICorner", Switch).CornerRadius = UDim.new(1,0)

    local Knob = Instance.new("Frame", Switch)
    Knob.Size = UDim2.new(0,18,0,18)
    Knob.Position = UDim2.new(0,1,0.5,-9)
    Knob.BackgroundColor3 = Color3.fromRGB(200,200,200)
    Instance.new("UICorner", Knob).CornerRadius = UDim.new(1,0)

    local Enabled = false
    Switch.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            Enabled = not Enabled
            TweenService:Create(Knob, TweenInfo.new(0.2), {
                Position = Enabled and UDim2.new(1,-19,0.5,-9) or UDim2.new(0,1,0.5,-9),
                BackgroundColor3 = Enabled and Color3.fromRGB(0,200,100) or Color3.fromRGB(200,200,200)
            }):Play()
            TweenService:Create(Switch, TweenInfo.new(0.2), {
                BackgroundColor3 = Enabled and Color3.fromRGB(0,120,60) or Color3.fromRGB(60,60,60)
            }):Play()
            if Callback then
                Callback(Enabled)
            end
        end
    end)
    
    return {Set = function(state) Enabled = state end}
end

-- Slider funcional
local function AddSlider(Parent, Text, Min, Max, Default, Callback)
    local Frame = Instance.new("Frame", Parent)
    Frame.Size = UDim2.new(1,-10,0,50)
    Frame.BackgroundTransparency = 1

    local Label = Instance.new("TextLabel", Frame)
    Label.Text = Text.." ["..Default.."]"
    Label.Size = UDim2.new(1,0,0,20)
    Label.TextColor3 = Color3.fromRGB(255,255,255)
    Label.BackgroundTransparency = 1
    Label.Font = Enum.Font.Gotham
    Label.TextSize = 12
    Label.TextXAlignment = Enum.TextXAlignment.Left

    local BarBack = Instance.new("TextButton", Frame)
    BarBack.Size = UDim2.new(1,0,0,8)
    BarBack.Position = UDim2.new(0,0,0,30)
    BarBack.BackgroundColor3 = Color3.fromRGB(50,50,50)
    BarBack.AutoButtonColor = false
    BarBack.Text = ""
    Instance.new("UICorner", BarBack).CornerRadius = UDim.new(0,4)

    local FillBar = Instance.new("Frame", BarBack)
    FillBar.Size = UDim2.new((Default-Min)/(Max-Min),0,1,0)
    FillBar.BackgroundColor3 = Color3.fromRGB(0,255,140)
    Instance.new("UICorner", FillBar).CornerRadius = UDim.new(0,4)

    local Knob = Instance.new("ImageButton", BarBack)
    Knob.Size = UDim2.new(0,16,0,16)
    Knob.Position = UDim2.new(FillBar.Size.X.Scale,-8,0.5,-8)
    Knob.BackgroundColor3 = Color3.fromRGB(255,255,255)
    Knob.Image = ""
    Knob.AutoButtonColor = false
    Instance.new("UICorner", Knob).CornerRadius = UDim.new(1,0)

    local draggingSlider = false

    local function setPercent(percent)
        percent = math.clamp(percent,0,1)
        FillBar.Size = UDim2.new(percent,0,1,0)
        Knob.Position = UDim2.new(percent,-8,0.5,-8)
        local Value = math.floor(Min + (Max-Min)*percent)
        Label.Text = Text.." ["..Value.."]"
        if Callback then Callback(Value) end
    end

    BarBack.MouseButton1Down:Connect(function()
        draggingSlider = true
        local mouseX = UserInputService:GetMouseLocation().X
        local relative = (mouseX - BarBack.AbsolutePosition.X)/BarBack.AbsoluteSize.X
        setPercent(relative)
    end)
    Knob.MouseButton1Down:Connect(function() draggingSlider = true end)
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then draggingSlider = false end
    end)
    RunService.RenderStepped:Connect(function()
        if draggingSlider then
            local mouseX = UserInputService:GetMouseLocation().X
            local relative = (mouseX - BarBack.AbsolutePosition.X)/BarBack.AbsoluteSize.X
            setPercent(relative)
        end
    end)

    setPercent((Default-Min)/(Max-Min))
end

-- Button funcional
local function AddButton(Parent, Text, Callback)
    local Btn = Instance.new("TextButton", Parent)
    Btn.Size = UDim2.new(1,-10,0,30)
    Btn.Text = Text
    Btn.BackgroundColor3 = Color3.fromRGB(45,45,45)
    Btn.TextColor3 = Color3.fromRGB(255,255,255)
    Btn.Font = Enum.Font.Gotham
    Btn.TextSize = 13
    Instance.new("UICorner", Btn).CornerRadius = UDim.new(0,6)

    Btn.MouseButton1Click:Connect(function()
        if Callback then Callback() end
    end)
end

--// SISTEMA HIT BOX
local HitBoxAtivo = false
local HitBoxTamanho = 5
local hitBoxes = {}
local hitBoxConnections = {}

local function criarHitBox(player)
    if hitBoxes[player] then return end
    
    local function atualizarHitBox(character)
        if not character then return end
        
        local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
        if not humanoidRootPart then return end
        
        -- Criar caixa de hit box
        local hitBox = Instance.new("BoxHandleAdornment")
        hitBox.Name = "HitBox"
        hitBox.Adornee = humanoidRootPart
        hitBox.AlwaysOnTop = true
        hitBox.ZIndex = 10
        hitBox.Size = Vector3.new(HitBoxTamanho, HitBoxTamanho, HitBoxTamanho)
        hitBox.Color3 = Color3.fromRGB(100, 150, 255) -- Azul claro
        hitBox.Transparency = 0.7
        hitBox.Parent = humanoidRootPart
        
        hitBoxes[player] = hitBox
        
        -- Atualizar tamanho quando mudar
        local connection
        connection = RunService.Heartbeat:Connect(function()
            if not HitBoxAtivo or not hitBox or not hitBox.Parent then
                if connection then
                    connection:Disconnect()
                end
                return
            end
            
            if humanoidRootPart and humanoidRootPart.Parent then
                hitBox.Size = Vector3.new(HitBoxTamanho, HitBoxTamanho, HitBoxTamanho)
            else
                if hitBox then
                    hitBox:Destroy()
                    hitBoxes[player] = nil
                end
                if connection then
                    connection:Disconnect()
                end
            end
        end)
        
        table.insert(hitBoxConnections, connection)
    end
    
    -- Criar hit box para personagem atual
    if player.Character then
        atualizarHitBox(player.Character)
    end
    
    -- Recriar quando o personagem mudar
    player.CharacterAdded:Connect(atualizarHitBox)
    player.CharacterRemoving:Connect(function()
        if hitBoxes[player] then
            hitBoxes[player]:Destroy()
            hitBoxes[player] = nil
        end
    end)
end

local function limparHitBoxes()
    for _, hitBox in pairs(hitBoxes) do
        if hitBox then
            hitBox:Destroy()
        end
    end
    hitBoxes = {}
    
    for _, connection in ipairs(hitBoxConnections) do
        if connection then
            connection:Disconnect()
        end
    end
    hitBoxConnections = {}
end

local function iniciarHitBox()
    -- Criar hit boxes para todos os jogadores
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            criarHitBox(player)
        end
    end
    
    -- Adicionar para novos jogadores
    Players.PlayerAdded:Connect(function(player)
        if player ~= LocalPlayer then
            criarHitBox(player)
        end
    end)
    
    -- Remover quando jogador sair
    Players.PlayerRemoving:Connect(function(player)
        if hitBoxes[player] then
            hitBoxes[player]:Destroy()
            hitBoxes[player] = nil
        end
    end)
end

--// SISTEMA FOV
local FOVAtivo = false
local FOVTamanho = 100
local FOVCircle

local function criarFOV()
    if FOVCircle then
        FOVCircle:Destroy()
        FOVCircle = nil
    end
    
    local camera = workspace.CurrentCamera
    local viewportSize = camera.ViewportSize
    
    FOVCircle = Instance.new("Frame")
    FOVCircle.Name = "FOVCircle"
    FOVCircle.Size = UDim2.new(0, FOVTamanho, 0, FOVTamanho)
    FOVCircle.Position = UDim2.new(0.5, -FOVTamanho/2, 0.5, -FOVTamanho/2)
    FOVCircle.BackgroundTransparency = 1
    FOVCircle.BorderSizePixel = 0
    FOVCircle.Parent = ScreenGui
    
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(1, 0)
    UICorner.Parent = FOVCircle
    
    local UIStroke = Instance.new("UIStroke")
    UIStroke.Color = Color3.fromRGB(255, 100, 100) -- Vermelho claro
    UIStroke.Thickness = 2
    UIStroke.Transparency = 0.3
    UIStroke.Parent = FOVCircle
end

local function atualizarFOV()
    if not FOVAtivo then
        if FOVCircle then
            FOVCircle:Destroy()
            FOVCircle = nil
        end
        return
    end
    
    if not FOVCircle then
        criarFOV()
    else
        FOVCircle.Size = UDim2.new(0, FOVTamanho, 0, FOVTamanho)
        FOVCircle.Position = UDim2.new(0.5, -FOVTamanho/2, 0.5, -FOVTamanho/2)
    end
end

--// SISTEMA ESP ITENS
local ESPItensAtivo = false
local ESPItensToggle
local verItensConexoes = {}
local ESPs = {}

local function limparESPItens()
    for _, conexao in ipairs(verItensConexoes) do
        conexao:Disconnect()
    end
    verItensConexoes = {}
    
    for _, esp in pairs(ESPs) do
        if esp then
            esp:Destroy()
        end
    end
    ESPs = {}
end

local function iniciarESPItens()
    -- ESP Itens Din√¢mico
    local Players = game:GetService("Players")
    local verItensUIAtivo = true

    -- Fun√ß√£o para adicionar ESP em um jogador
    local function adicionarUI(player)
        if player == Players.LocalPlayer then return end
        if ESPs[player] then return end -- Evita duplicar

        local function criarBillboard()
            local character = player.Character or player.CharacterAdded:Wait()
            local head = character:WaitForChild("Head", 3)
            if not head then return end

            local gui = Instance.new("BillboardGui")
            gui.Name = "ItemUI"
            gui.Adornee = head
            gui.Size = UDim2.new(0, 160, 0, 60)
            gui.StudsOffset = Vector3.new(0, 2.8, 0)
            gui.AlwaysOnTop = true

            local nameLabel = Instance.new("TextLabel")
            nameLabel.Size = UDim2.new(1, 0, 0.3, 0)
            nameLabel.Position = UDim2.new(0, 0, 0, 0)
            nameLabel.BackgroundTransparency = 1
            nameLabel.TextColor3 = Color3.new(1, 1, 1)
            nameLabel.TextStrokeTransparency = 0.5
            nameLabel.Font = Enum.Font.SourceSansBold
            nameLabel.TextScaled = true
            nameLabel.Text = player.Name
            nameLabel.Parent = gui

            local itensLabel = Instance.new("TextLabel")
            itensLabel.Size = UDim2.new(1, 0, 0.7, 0)
            itensLabel.Position = UDim2.new(0, 0, 0.3, 0)
            itensLabel.BackgroundTransparency = 1
            itensLabel.TextColor3 = Color3.new(1, 1, 1)
            itensLabel.TextStrokeTransparency = 0.6
            itensLabel.Font = Enum.Font.SourceSans
            itensLabel.TextScaled = true
            itensLabel.TextWrapped = true
            itensLabel.Text = ""
            itensLabel.Parent = gui

            local function update()
                local list = {}
                if player:FindFirstChild("Backpack") then
                    for _, item in ipairs(player.Backpack:GetChildren()) do
                        table.insert(list, item.Name)
                    end
                end
                if player.Character then
                    for _, item in ipairs(player.Character:GetChildren()) do
                        if item:IsA("Tool") then
                            table.insert(list, item.Name)
                        end
                    end
                end
                itensLabel.Text = table.concat(list, ", ")
            end

            update()
            table.insert(verItensConexoes, player.Backpack.ChildAdded:Connect(update))
            table.insert(verItensConexoes, player.Backpack.ChildRemoved:Connect(update))
            table.insert(verItensConexoes, player.Character.ChildAdded:Connect(update))
            table.insert(verItensConexoes, player.Character.ChildRemoved:Connect(update))

            gui.Parent = head
            ESPs[player] = gui
        end

        -- Se o personagem j√° existe, cria o ESP
        if player.Character then
            criarBillboard()
        end

        -- Recria o ESP se o jogador morrer e respawnar
        player.CharacterAdded:Connect(function()
            task.wait(0.5)
            if verItensUIAtivo then
                if ESPs[player] then
                    ESPs[player]:Destroy()
                    ESPs[player] = nil
                end
                criarBillboard()
            end
        end)
    end

    -- Remove ESP ao sair do jogador
    local function removerUI(player)
        if ESPs[player] then
            ESPs[player]:Destroy()
            ESPs[player] = nil
        end
    end

    -- Inicializa ESP para jogadores existentes
    for _, player in pairs(Players:GetPlayers()) do
        adicionarUI(player)
    end

    -- Atualiza ESP para jogadores que entram
    Players.PlayerAdded:Connect(function(player)
        adicionarUI(player)
    end)

    -- Remove ESP quando um jogador sai
    Players.PlayerRemoving:Connect(function(player)
        removerUI(player)
    end)
end

--// SISTEMA ESP LINE
local ESPLineAtivo = false
local ESPLineBeams = {}
local ESPLineConnections = {}
local ESPLineLocalPart = nil
local ESPLineLocalAttachment = nil

local function ESPLine_rgbColor(t)
    local r = math.floor((math.sin(t * 2) * 0.5 + 0.5) * 255)
    local g = math.floor((math.sin(t * 2 + 2) * 0.5 + 0.5) * 255)
    local b = math.floor((math.sin(t * 2 + 4) * 0.5 + 0.5) * 255)
    return Color3.fromRGB(r, g, b)
end

local function ESPLine_ensureLocalPart()
    if ESPLineLocalPart and ESPLineLocalPart.Parent then return end

    if ESPLineLocalPart and ESPLineLocalPart.Parent then
        pcall(function() ESPLineLocalPart:Destroy() end)
    end

    ESPLineLocalPart = Instance.new("Part")
    ESPLineLocalPart.Name = "ESPLocalAnchor"
    ESPLineLocalPart.Size = Vector3.new(0.2, 0.2, 0.2)
    ESPLineLocalPart.Transparency = 1
    ESPLineLocalPart.Anchored = true
    ESPLineLocalPart.CanCollide = false
    ESPLineLocalPart.Massless = true
    ESPLineLocalPart.Parent = workspace

    ESPLineLocalAttachment = Instance.new("Attachment")
    ESPLineLocalAttachment.Name = "ESP_Local_Attachment"
    ESPLineLocalAttachment.Parent = ESPLineLocalPart
end

local function ESPLine_updateLocalPart()
    local char = LocalPlayer.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    local pos = hrp.Position - Vector3.new(0, 3, 0)
    ESPLineLocalPart.CFrame = CFrame.new(pos)
end

local function ESPLine_destroyBeamFor(targetPlayer)
    local info = ESPLineBeams[targetPlayer]
    if not info then return end

    pcall(function()
        if info.beamPart and info.beamPart.Parent then
            info.beamPart:Destroy()
        end
    end)

    if info.createdAttachment and info.attachment1 and info.attachment1.Parent then
        pcall(function() info.attachment1:Destroy() end)
    end

    ESPLineBeams[targetPlayer] = nil
end

local function ESPLine_createBeamFor(targetPlayer)
    if not targetPlayer or targetPlayer == LocalPlayer then return end
    if ESPLineBeams[targetPlayer] then return end

    local char = targetPlayer.Character
    local hrp = (char and char:FindFirstChild("HumanoidRootPart")) and char.HumanoidRootPart or nil
    if not hrp then return end

    local attachName = "ESP_Target_Attachment_ChatGPT"
    local attachment1 = hrp:FindFirstChild(attachName)
    local created = false
    if not attachment1 then
        attachment1 = Instance.new("Attachment")
        attachment1.Name = attachName
        attachment1.Parent = hrp
        created = true
    end

    local beamPart = Instance.new("Part")
    beamPart.Name = "ESP_BeamContainer_" .. targetPlayer.Name
    beamPart.Size = Vector3.new(0.1, 0.1, 0.1)
    beamPart.Transparency = 1
    beamPart.Anchored = true
    beamPart.CanCollide = false
    beamPart.Parent = workspace

    local beam = Instance.new("Beam")
    beam.Name = "ESP_BeamRGB"
    beam.Attachment0 = ESPLineLocalAttachment
    beam.Attachment1 = attachment1
    beam.FaceCamera = true
    beam.Segments = 4
    beam.Width0 = 0.08
    beam.Width1 = 0.08
    beam.Transparency = NumberSequence.new(0)
    beam.TextureMode = Enum.TextureMode.Stretch
    beam.Parent = beamPart

    ESPLineBeams[targetPlayer] = {
        beamPart = beamPart,
        beam = beam,
        attachment1 = attachment1,
        createdAttachment = created
    }
end

local function ESPLine_initAllPlayers()
    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer then
            ESPLineConnections[plr] = {}
            ESPLineConnections[plr].charAdded = plr.CharacterAdded:Connect(function(char)
                local hrp = char:WaitForChild("HumanoidRootPart", 5)
                if hrp then
                    ESPLine_createBeamFor(plr)
                end
            end)

            if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                ESPLine_createBeamFor(plr)
            end

            ESPLineConnections[plr].charRemoving = plr.CharacterRemoving:Connect(function()
                ESPLine_destroyBeamFor(plr)
            end)

            ESPLineConnections[plr].playerRemoving = Players.PlayerRemoving:Connect(function(rem)
                if rem == plr then
                    ESPLine_destroyBeamFor(plr)
                    if ESPLineConnections[plr] then
                        for _, c in pairs(ESPLineConnections[plr]) do
                            if c and typeof(c) == "RBXScriptConnection" then
                                pcall(function() c:Disconnect() end)
                            end
                        end
                        ESPLineConnections[plr] = nil
                    end
                end
            end)
        end
    end
end

local function ESPLine_destroyAll()
    for plr, _ in pairs(ESPLineBeams) do
        ESPLine_destroyBeamFor(plr)
    end
    if ESPLineLocalPart and ESPLineLocalPart.Parent then
        pcall(function() ESPLineLocalPart:Destroy() end)
    end
    for plr, conns in pairs(ESPLineConnections) do
        for _, c in pairs(conns) do
            if c and typeof(c) == "RBXScriptConnection" then
                pcall(function() c:Disconnect() end)
            end
        end
    end
    ESPLineBeams = {}
    ESPLineConnections = {}
end

local function iniciarESPLine()
    ESPLine_ensureLocalPart()
    ESPLine_initAllPlayers()

    Players.PlayerAdded:Connect(function(plr)
        task.defer(function()
            ESPLineConnections[plr] = {}
            ESPLineConnections[plr].charAdded = plr.CharacterAdded:Connect(function(char)
                local hrp = char:WaitForChild("HumanoidRootPart", 5)
                if hrp then
                    ESPLine_createBeamFor(plr)
                end
            end)

            ESPLineConnections[plr].charRemoving = plr.CharacterRemoving:Connect(function()
                ESPLine_destroyBeamFor(plr)
            end)

            ESPLineConnections[plr].playerRemoving = Players.PlayerRemoving:Connect(function(rem)
                if rem == plr then
                    ESPLine_destroyBeamFor(plr)
                    if ESPLineConnections[plr] then
                        for _, c in pairs(ESPLineConnections[plr]) do
                            if c and typeof(c) == "RBXScriptConnection" then
                                pcall(function() c:Disconnect() end)
                            end
                        end
                        ESPLineConnections[plr] = nil
                    end
                end
            end)
        end)
    end)

    Players.PlayerRemoving:Connect(function(plr)
        ESPLine_destroyBeamFor(plr)
        if ESPLineConnections[plr] then
            for _, c in pairs(ESPLineConnections[plr]) do
                if c and typeof(c) == "RBXScriptConnection" then
                    pcall(function() c:Disconnect() end)
                end
            end
            ESPLineConnections[plr] = nil
        end
    end)

    LocalPlayer.CharacterAdded:Connect(function(char)
        task.wait(0.1)
        ESPLine_ensureLocalPart()
        for plr, _ in pairs(ESPLineBeams) do
            ESPLine_destroyBeamFor(plr)
        end
        ESPLine_initAllPlayers()
    end)

    -- Loop de atualiza√ß√£o
    local ESPLineConnection = RunService.RenderStepped:Connect(function(dt)
        if not ESPLineAtivo then return end
        pcall(ESPLine_updateLocalPart)

        local t = tick()
        local color = ESPLine_rgbColor(t)

        for plr, info in pairs(ESPLineBeams) do
            pcall(function()
                if not plr.Parent then
                    ESPLine_destroyBeamFor(plr)
                    return
                end

                if not (info.attachment1 and info.attachment1.Parent) then
                    ESPLine_destroyBeamFor(plr)
                    return
                end

                if info.beam and info.beam.Parent then
                    info.beam.Color = ColorSequence.new(color)
                    info.beam.Width0 = 0.06
                    info.beam.Width1 = 0.06
                end

                if info.beamPart and info.beamPart.Parent and ESPLineLocalPart then
                    info.beamPart.Position = ESPLineLocalPart.Position
                end
            end)
        end
    end)

    table.insert(ESPLineConnections, ESPLineConnection)
end

--// SISTEMA ESP BOX 2D
local ESPBox2DAtivo = false
local ESPBox2DDrawings = {}

local function ESPBox2D_CreateFullBodyBox(player)
    if player == LocalPlayer then return end

    local box = Drawing.new("Square")
    box.Color = Color3.fromRGB(255, 0, 0)
    box.Thickness = 2
    box.Filled = false
    box.Visible = false

    ESPBox2DDrawings[player] = box

    local function Update()
        if not ESPBox2DAtivo then
            box.Visible = false
            return
        end

        if not player.Character then
            box.Visible = false
            return
        end

        local hrp = player.Character:FindFirstChild("HumanoidRootPart")
        local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
        if not hrp or not humanoid then
            box.Visible = false
            return
        end

        local parts = {}
        for _, partName in pairs({"Head","UpperTorso","LowerTorso","LeftUpperArm","RightUpperArm","LeftUpperLeg","RightUpperLeg"}) do
            local part = player.Character:FindFirstChild(partName)
            if part then table.insert(parts, part) end
        end

        if #parts == 0 then
            box.Visible = false
            return
        end

        local minX, minY = math.huge, math.huge
        local maxX, maxY = -math.huge, -math.huge

        for _, part in pairs(parts) do
            local corners = {
                part.Position + Vector3.new( part.Size.X/2,  part.Size.Y/2,  part.Size.Z/2),
                part.Position + Vector3.new( part.Size.X/2,  part.Size.Y/2, -part.Size.Z/2),
                part.Position + Vector3.new( part.Size.X/2, -part.Size.Y/2,  part.Size.Z/2),
                part.Position + Vector3.new( part.Size.X/2, -part.Size.Y/2, -part.Size.Z/2),
                part.Position + Vector3.new(-part.Size.X/2,  part.Size.Y/2,  part.Size.Z/2),
                part.Position + Vector3.new(-part.Size.X/2,  part.Size.Y/2, -part.Size.Z/2),
                part.Position + Vector3.new(-part.Size.X/2, -part.Size.Y/2,  part.Size.Z/2),
                part.Position + Vector3.new(-part.Size.X/2, -part.Size.Y/2, -part.Size.Z/2)
            }

            for _, corner in pairs(corners) do
                local screenPos, onScreen = workspace.CurrentCamera:WorldToViewportPoint(corner)
                if onScreen then
                    minX = math.min(minX, screenPos.X)
                    minY = math.min(minY, screenPos.Y)
                    maxX = math.max(maxX, screenPos.X)
                    maxY = math.max(maxY, screenPos.Y)
                end
            end
        end

        if minX < maxX and minY < maxY then
            box.Position = Vector2.new(minX, minY)
            box.Size = Vector2.new(maxX - minX, maxY - minY)
            box.Visible = true
        else
            box.Visible = false
        end
    end

    local conn = RunService.RenderStepped:Connect(Update)
    ESPBox2DDrawings[player].connection = conn

    player.AncestryChanged:Connect(function(_, parent)
        if not parent then
            conn:Disconnect()
            box:Remove()
            ESPBox2DDrawings[player] = nil
        end
    end)
end

local function ESPBox2D_DestroyAll()
    for player, drawing in pairs(ESPBox2DDrawings) do
        if drawing.connection then
            drawing.connection:Disconnect()
        end
        if typeof(drawing) == "Drawing" then
            drawing:Remove()
        end
    end
    ESPBox2DDrawings = {}
end

--// SISTEMA ESP NAME
local ESPNameAtivo = false
local ESPNameBillboards = {}

local function ESPName_CreateNameESP(player)
    if player == LocalPlayer then return end

    local billboard = Instance.new("BillboardGui")
    billboard.Name = player.Name .. "_ESPName"
    billboard.AlwaysOnTop = true
    billboard.Size = UDim2.new(0, 100, 0, 20)
    billboard.StudsOffset = Vector3.new(0, 2.5, 0)
    billboard.Adornee = nil
    billboard.Enabled = false
    billboard.Parent = CoreGui

    local nameLabel = Instance.new("TextLabel")
    nameLabel.Size = UDim2.new(1, 0, 1, 0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = player.Name
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    nameLabel.TextStrokeTransparency = 0.2
    nameLabel.TextScaled = true
    nameLabel.Font = Enum.Font.GothamBold
    nameLabel.Parent = billboard

    ESPNameBillboards[player] = billboard

    local function Update()
        if not ESPNameAtivo then
            billboard.Enabled = false
            return
        end

        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local root = player.Character.HumanoidRootPart
            billboard.Adornee = root
            billboard.Enabled = true
        else
            billboard.Enabled = false
        end
    end

    local conn = RunService.RenderStepped:Connect(Update)
    ESPNameBillboards[player].connection = conn

    player.AncestryChanged:Connect(function(_, parent)
        if not parent then
            conn:Disconnect()
            billboard:Destroy()
            ESPNameBillboards[player] = nil
        end
    end)
end

local function ESPName_DestroyAll()
    for player, billboard in pairs(ESPNameBillboards) do
        if billboard.connection then
            billboard.connection:Disconnect()
        end
        billboard:Destroy()
    end
    ESPNameBillboards = {}
end

--// SISTEMA ESP VIDA
local ESPVidaAtivo = false
local ESPVidaDrawings = {}

local function ESPVida_CreateHealthNumberESP(player)
    if player == LocalPlayer then return end

    local healthText = Drawing.new("Text")
    healthText.Color = Color3.fromRGB(255, 105, 180)
    healthText.Size = 18
    healthText.Center = true
    healthText.Outline = true
    healthText.OutlineColor = Color3.new(0,0,0)
    healthText.Visible = false
    healthText.Font = 2

    ESPVidaDrawings[player] = healthText

    local function Update()
        if not ESPVidaAtivo then
            healthText.Visible = false
            return
        end

        if not player.Character then
            healthText.Visible = false
            return
        end

        local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
        local hrp = player.Character:FindFirstChild("HumanoidRootPart")
        if not humanoid or not hrp then
            healthText.Visible = false
            return
        end

        local pos, onScreen = workspace.CurrentCamera:WorldToViewportPoint(hrp.Position - Vector3.new(0, 3, 0))
        if onScreen and humanoid.Health > 0 then
            healthText.Position = Vector2.new(pos.X, pos.Y)
            healthText.Text = tostring(math.floor(humanoid.Health))
            healthText.Visible = true
        else
            healthText.Visible = false
        end
    end

    local conn = RunService.RenderStepped:Connect(Update)
    ESPVidaDrawings[player].connection = conn

    player.AncestryChanged:Connect(function(_, parent)
        if not parent then
            conn:Disconnect()
            healthText:Remove()
            ESPVidaDrawings[player] = nil
        end
    end)
end

local function ESPVida_DestroyAll()
    for player, drawing in pairs(ESPVidaDrawings) do
        if drawing.connection then
            drawing.connection:Disconnect()
        end
        if typeof(drawing) == "Drawing" then
            drawing:Remove()
        end
    end
    ESPVidaDrawings = {}
end

--// SISTEMA MOSTRAR FPS/PING
local MostrarFPSPingAtivo = false
local FPSPingUI

local function iniciarFPSPingUI()
    if FPSPingUI then
        FPSPingUI:Destroy()
    end

    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "FPSPingUI"
    ScreenGui.IgnoreGuiInset = true
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Enabled = MostrarFPSPingAtivo
    ScreenGui.Parent = CoreGui

    local Frame = Instance.new("Frame")
    Frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    Frame.BackgroundTransparency = 0.6
    Frame.BorderSizePixel = 0
    Frame.Size = UDim2.new(0, 190, 0, 45)
    Frame.Position = UDim2.new(0.75, 0, 0.9, 0)
    Frame.AnchorPoint = Vector2.new(0.5, 0)
    Frame.Parent = ScreenGui
    Frame.Active = true

    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 10)
    UICorner.Parent = Frame

    local FPSLabel = Instance.new("TextLabel")
    FPSLabel.BackgroundTransparency = 1
    FPSLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
    FPSLabel.TextScaled = true
    FPSLabel.Font = Enum.Font.Code
    FPSLabel.Text = "FPS: 0"
    FPSLabel.Size = UDim2.new(0.5, 0, 1, 0)
    FPSLabel.Position = UDim2.new(0, 10, 0, 0)
    FPSLabel.TextXAlignment = Enum.TextXAlignment.Left
    FPSLabel.Parent = Frame

    local PingLabel = Instance.new("TextLabel")
    PingLabel.BackgroundTransparency = 1
    PingLabel.TextColor3 = Color3.fromRGB(0, 200, 255)
    PingLabel.TextScaled = true
    PingLabel.Font = Enum.Font.Code
    PingLabel.Text = "Ping: 0 ms"
    PingLabel.Size = UDim2.new(0.5, -10, 1, 0)
    PingLabel.Position = UDim2.new(0.5, 0, 0, 0)
    PingLabel.TextXAlignment = Enum.TextXAlignment.Right
    PingLabel.Parent = Frame

    local lastUpdate = tick()
    local frameCount = 0
    local fps = 0

    RunService.RenderStepped:Connect(function()
        if not MostrarFPSPingAtivo then return end
        frameCount += 1
        if tick() - lastUpdate >= 1 then
            fps = frameCount
            frameCount = 0
            lastUpdate = tick()
            FPSLabel.Text = "FPS: " .. tostring(fps)
            if fps >= 55 then
                FPSLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
            elseif fps >= 30 then
                FPSLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
            else
                FPSLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
            end
        end
    end)

    task.spawn(function()
        while task.wait(1) do
            if not MostrarFPSPingAtivo then continue end
            local ping = game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValueString()
            ping = string.gsub(ping, " ms", "")
            local pingNum = tonumber(ping) or 0
            PingLabel.Text = "Ping: " .. pingNum .. " ms"
            if pingNum <= 80 then
                PingLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
            elseif pingNum <= 150 then
                PingLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
            else
                PingLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
            end
        end
    end)

    FPSPingUI = ScreenGui
end

--// SISTEMA SPEED HACK (Funciona mesmo fechando o menu)
local speedAtivo = false
local speedValor = 16

local function atualizarSpeed()
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("Humanoid") then
        char.Humanoid.WalkSpeed = speedAtivo and speedValor or 16
    end
end

LocalPlayer.CharacterAdded:Connect(function(char)
    local humanoid = char:WaitForChild("Humanoid")
    humanoid.WalkSpeed = speedAtivo and speedValor or 16
end)

RunService.Heartbeat:Connect(function()
    if speedAtivo then
        atualizarSpeed()
    end
end)

--// SISTEMA NOCLIP
local NoclipAtivo = false
local noclipConnection

local function iniciarNoclip()
    if noclipConnection then
        noclipConnection:Disconnect()
    end
    
    noclipConnection = RunService.Stepped:Connect(function()
        if NoclipAtivo and LocalPlayer.Character then
            for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = false
                end
            end
        end
    end)
end

local function pararNoclip()
    if noclipConnection then
        noclipConnection:Disconnect()
        noclipConnection = nil
    end
    
    if LocalPlayer.Character then
        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = true
            end
        end
    end
end

--// SISTEMA ANTI REVISTAR
local AntiRevistarAtivo = false
local antiRevistarConnection

local function iniciarAntiRevistar()
    if antiRevistarConnection then
        antiRevistarConnection:Disconnect()
    end
    
    antiRevistarConnection = RunService.Heartbeat:Connect(function()
        if AntiRevistarAtivo and LocalPlayer.Character then
            local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid and humanoid.Health < 5 then
                LocalPlayer:Kick("üíÄ Voc√™ foi kickado automaticamente por ser muito burro! (Vida menor que 5)")
            end
        end
    end)
end

local function pararAntiRevistar()
    if antiRevistarConnection then
        antiRevistarConnection:Disconnect()
        antiRevistarConnection = nil
    end
end

--// SISTEMA AIMBOT PC
local AimbotPCAtivo = false
local AimbotPCToggle

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local Mouse = LocalPlayer:GetMouse()

local AimbotAtivo = true
local AnguloMaximo = math.rad(20)

local function getFOV(p0, p1, deg)
    local x1, y1, z1 = p0:ToOrientation()
    local cf = CFrame.new(p0.p, p1.p)
    local x2, y2, z2 = cf:ToOrientation()
    if deg then
        return Vector3.new(math.deg(x1 - x2), math.deg(y1 - y2), math.deg(z1 - z2))
    else
        return Vector3.new((x1 - x2), (y1 - y2), (z1 - z2))
    end
end

local function checkFOV(part)
    local fov = getFOV(Camera.CFrame, part.CFrame)
    local angle = math.abs(fov.X) + math.abs(fov.Y)
    return angle
end

local function aimAt(part)
    Camera.CFrame = CFrame.new(Camera.CFrame.Position, part.Position)
end

local Aiming = false
local AimPart = nil

local function iniciarAimbotPC()
    Mouse.Button2Down:Connect(function()
        if not AimbotPCAtivo then return end
        Aiming = true
        local closest = nil
        local smallest = AnguloMaximo
        for _, plr in pairs(Players:GetPlayers()) do
            if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("Head") then
                local hum = plr.Character:FindFirstChildOfClass("Humanoid")
                if hum and hum.Health > 0 then
                    local ang = checkFOV(plr.Character.Head)
                    if ang < smallest then
                        smallest = ang
                        closest = plr.Character.Head
                    end
                end
            end
        end
        AimPart = closest
    end)

    Mouse.Button2Up:Connect(function()
        Aiming = false
        AimPart = nil
    end)

    RunService.RenderStepped:Connect(function()
        if AimbotPCAtivo and Aiming and AimPart then
            if AimPart.Parent and AimPart.Parent:FindFirstChildOfClass("Humanoid") and AimPart.Parent:FindFirstChildOfClass("Humanoid").Health > 0 then
                aimAt(AimPart)
            else
                AimPart = nil
            end
        end
    end)
end

--// SISTEMA AIMBOT MOBILE (Corrigido - n√£o fica travado)
local AimbotMobileAtivo = false
local AimbotMobileToggle
local aimbotMobileConnection

local function iniciarAimbotMobile()
    if aimbotMobileConnection then
        aimbotMobileConnection:Disconnect()
    end
    
    local Camera = workspace.CurrentCamera
    
    aimbotMobileConnection = RunService.RenderStepped:Connect(function()
        if AimbotMobileAtivo then
            local melhorAlvo = nil
            local menorDistancia = math.huge
            local posicaoCamera = Camera.CFrame.Position
            local direcaoCamera = Camera.CFrame.LookVector
            
            for _, jogador in pairs(Players:GetPlayers()) do
                if jogador ~= LocalPlayer and jogador.Character and jogador.Character:FindFirstChild("Head") then
                    local humanoide = jogador.Character:FindFirstChildOfClass("Humanoid")
                    if humanoide and humanoide.Health > 0 then
                        local posicaoAlvo = jogador.Character.Head.Position
                        local direcaoParaAlvo = (posicaoAlvo - posicaoCamera).Unit
                        local produtoEscalar = direcaoCamera:Dot(direcaoParaAlvo)
                        
                        if produtoEscalar > 0.5 then
                            local distancia = (posicaoAlvo - posicaoCamera).Magnitude
                            if distancia < menorDistancia then
                                menorDistancia = distancia
                                melhorAlvo = jogador.Character.Head
                            end
                        end
                    end
                end
            end
            
            if melhorAlvo then
                local novaCFrame = CFrame.new(Camera.CFrame.Position, melhorAlvo.Position)
                Camera.CFrame = Camera.CFrame:Lerp(novaCFrame, 0.3)
            end
        end
    end)
end

local function pararAimbotMobile()
    if aimbotMobileConnection then
        aimbotMobileConnection:Disconnect()
        aimbotMobileConnection = nil
    end
end

--// SISTEMA TP KILL
local TPKillAtivo = false
local TPKillToggle

local function iniciarTPKill()
    local Players = game:GetService("Players")
    local RunService = game:GetService("RunService")
    local LocalPlayer = Players.LocalPlayer

    local teleportAutoAtivo = true
    local ultimoMorto = nil
    local jaTeleportou = false

    local function teleportarParaMorto()
        if not teleportAutoAtivo or not ultimoMorto or jaTeleportou then return end
        
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            if ultimoMorto.Character and ultimoMorto.Character:FindFirstChild("HumanoidRootPart") then
                char.HumanoidRootPart.CFrame = ultimoMorto.Character.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0)
                jaTeleportou = true
                print("üéØ Teleportado para: " .. ultimoMorto.Name)
            end
        end
    end

    local function monitorarKills(jogador)
        if jogador == LocalPlayer then return end
        
        local function morte(char)
            local humanoid = char:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.Died:Connect(function()
                    local killer = humanoid:FindFirstChild("creator") or humanoid:FindFirstChild("Creator")
                    if killer and killer.Value == LocalPlayer then
                        ultimoMorto = jogador
                        jaTeleportou = false
                        print("üéØ Eliminou: " .. jogador.Name)
                        teleportarParaMorto()
                    end
                end)
            end
        end
        
        jogador.CharacterAdded:Connect(morte)
        if jogador.Character then morte(jogador.Character) end
    end

    for _, jogador in pairs(Players:GetPlayers()) do
        monitorarKills(jogador)
    end

    Players.PlayerAdded:Connect(monitorarKills)

    RunService.Heartbeat:Connect(function()
        if teleportAutoAtivo and ultimoMorto and not jaTeleportou then
            teleportarParaMorto()
        end
    end)

    print("üéØ TP Kill Ativo - Teleporta automaticamente ap√≥s eliminar jogadores")
end

--// SISTEMA AUTO REVISTAR
local AutoRevistarAtivo = false
local AutoRevistarToggle
local revistarCoroutine = nil
local detectados = {}
local DETECTION_RADIUS = 20
local CheckInterval = 1

local function isDead(player)
    if player.Character then
        local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
        return humanoid and humanoid.Health <= 0
    end
    return false
end

local function distanceBetween(pos1, pos2)
    return (pos1 - pos2).Magnitude
end

local function notificar(titulo, mensagem, duracao)
    print("[" .. titulo .. "] " .. mensagem)
end

local function pararRevistar()
    AutoRevistarAtivo = false
    if revistarCoroutine then
        coroutine.close(revistarCoroutine)
        revistarCoroutine = nil
    end
    detectados = {}
end

local function iniciarRevistar()
    if revistarCoroutine then return end
    AutoRevistarAtivo = true
    
    local dsada = game:GetService("ReplicatedStorage"):FindFirstChild("RemoteNovos") and 
                  game:GetService("ReplicatedStorage").RemoteNovos:FindFirstChild("bixobrabo")
    
    revistarCoroutine = coroutine.create(function()
        while AutoRevistarAtivo do
            local char = LocalPlayer.Character
            if char and char:FindFirstChild("HumanoidRootPart") then
                local pos = char.HumanoidRootPart.Position
                for _, otherPlayer in pairs(Players:GetPlayers()) do
                    if otherPlayer ~= LocalPlayer and isDead(otherPlayer) and 
                       otherPlayer.Character and otherPlayer.Character:FindFirstChild("HumanoidRootPart") then
                        local otherPos = otherPlayer.Character.HumanoidRootPart.Position
                        if distanceBetween(pos, otherPos) <= DETECTION_RADIUS then
                            if not detectados[otherPlayer] then
                                detectados[otherPlayer] = true
                                if dsada then
                                    pcall(function()
                                        dsada:FireServer("/revistar morto")
                                        print("üîç Revistando: " .. otherPlayer.Name)
                                    end)
                                end
                            end
                        else
                            detectados[otherPlayer] = nil
                        end
                    end
                end
            end
            wait(CheckInterval)
        end
    end)
    coroutine.resume(revistarCoroutine)
    notificar("Revistar Autom√°tico", "Ativado!", 2)
end

--// Adicionar componentes na tab COMBATE

-- Hit Box
AddToggle(TabCombate, "Hit Box", function(v)
    HitBoxAtivo = v
    if v then
        iniciarHitBox()
    else
        limparHitBoxes()
    end
end)

AddSlider(TabCombate, "Tamanho Hit Box", 1, 20, 5, function(v)
    HitBoxTamanho = v
    if HitBoxAtivo then
        for _, hitBox in pairs(hitBoxes) do
            if hitBox and hitBox.Parent then
                hitBox.Size = Vector3.new(HitBoxTamanho, HitBoxTamanho, HitBoxTamanho)
            end
        end
    end
end)

-- FOV
AddToggle(TabCombate, "FOV Circle", function(v)
    FOVAtivo = v
    atualizarFOV()
end)

AddSlider(TabCombate, "Tamanho FOV", 50, 300, 100, function(v)
    FOVTamanho = v
    atualizarFOV()
end)

-- Speed Hack
AddToggle(TabCombate, "Speed Hack", function(v)
    speedAtivo = v
    atualizarSpeed()
end)

AddSlider(TabCombate, "Velocidade", 16, 400, 16, function(v)
    speedValor = v
    if speedAtivo then
        atualizarSpeed()
    end
end)

-- Noclip
AddToggle(TabCombate, "Noclip", function(v)
    NoclipAtivo = v
    if v then
        iniciarNoclip()
    else
        pararNoclip()
    end
end)

-- Anti Revistar
AddToggle(TabCombate, "Anti Revistar", function(v)
    AntiRevistarAtivo = v
    if v then
        iniciarAntiRevistar()
    else
        pararAntiRevistar()
    end
end)

AimbotPCToggle = AddToggle(TabCombate, "Aimbot PC", function(v)
    AimbotPCAtivo = v
    if v then
        iniciarAimbotPC()
    end
end)

AimbotMobileToggle = AddToggle(TabCombate, "Aimbot Mobile", function(v)
    AimbotMobileAtivo = v
    if v then
        iniciarAimbotMobile()
    else
        pararAimbotMobile()
    end
end)

TPKillToggle = AddToggle(TabCombate, "TP Kill", function(v)
    TPKillAtivo = v
    if v then
        iniciarTPKill()
    end
end)

AutoRevistarToggle = AddToggle(TabCombate, "Auto Revistar", function(v)
    if v then
        iniciarRevistar()
    else
        pararRevistar()
    end
end)

-- Bot√£o Auto Roubar Inv PC
AddButton(TabCombate, "Auto Roubar Inv PC", function()
    game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui"):FindFirstChild("NotifyGui"):Destroy()

    local NotifyBackup = game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("NotifyGui") and game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("NotifyGui"):Clone()

    game:GetService("RunService").Heartbeat:Connect(function()
        for _, Item in ipairs({
            "Glock 17", "Hi Power", "AK47", "PARAFAL", "Uzi", "G3", "IA2",
            string.char(65, 82, 45, 49, 53),
            "Faca", "Natalina", "Lockpick", "Escudo", "Skate", "Planta Suja",
            "Planta Limpa", "Tratamento"
        }) do
            game:GetService("ReplicatedStorage").Modules.InvRemotes.InvRequest:InvokeServer("mudaInv", "3", Item, "1")
            task.wait(0.1)
        end
    end)
end)

-- Bot√£o Auto Roubar Inv Mobile
AddButton(TabCombate, "Auto Roubar Inv Mobile", function()
    local Players = game:GetService("Players")
    local ReplicatedStorage = game:GetService("ReplicatedStorage")
    local RunService = game:GetService("RunService")

    local LocalPlayer = Players.LocalPlayer

    local function SafeDestroyNotify()
        local gui = LocalPlayer:WaitForChild("PlayerGui"):FindFirstChild("NotifyGui")
        if gui then
            gui:Destroy()
        end
    end

    local function BackupNotify()
        local gui = LocalPlayer.PlayerGui:FindFirstChild("NotifyGui")
        if gui then
            return gui:Clone()
        end
    end

    SafeDestroyNotify()
    local NotifyBackup = BackupNotify()

    RunService.Heartbeat:Connect(function()
        local itens = {
            "Glock 17", "Hi Power", "AK47", "PARAFAL", "Uzi", "G3", "IA2",
            string.char(65, 82, 45, 49, 53),
            "Faca", "Natalina", "Lockpick", "Escudo", "Skate", "Planta Suja",
            "Planta Limpa", "Tratamento"
        }

        for _, Item in ipairs(itens) do
            local success, err = pcall(function()
                ReplicatedStorage.Modules.InvRemotes.InvRequest:InvokeServer("mudaInv", "3", Item, "1")
            end)
            if not success then
                warn("Erro ao adicionar item:", Item, err)
            end
            task.wait(0.1)
        end
    end)
end)

--// Adicionar componentes na tab VISUAL

-- ESP Itens
ESPItensToggle = AddToggle(TabVisual, "ESP Itens", function(v)
    ESPItensAtivo = v
    if v then
        iniciarESPItens()
    else
        limparESPItens()
    end
end)

-- ESP Line
AddToggle(TabVisual, "ESP Line", function(v)
    ESPLineAtivo = v
    if v then
        iniciarESPLine()
    else
        ESPLine_destroyAll()
    end
end)


-- ESP Box 2D
AddToggle(TabVisual, "ESP Box 2D", function(v)
    ESPBox2DAtivo = v
    if v then
        for _, player in pairs(Players:GetPlayers()) do
            ESPBox2D_CreateFullBodyBox(player)
        end
        Players.PlayerAdded:Connect(ESPBox2D_CreateFullBodyBox)
    else
        ESPBox2D_DestroyAll()
    end
end)

-- ESP Name
AddToggle(TabVisual, "ESP Name", function(v)
    ESPNameAtivo = v
    if v then
        for _, player in pairs(Players:GetPlayers()) do
            ESPName_CreateNameESP(player)
        end
        Players.PlayerAdded:Connect(ESPName_CreateNameESP)
    else
        ESPName_DestroyAll()
    end
end)

-- ESP Vida
AddToggle(TabVisual, "ESP Vida", function(v)
    ESPVidaAtivo = v
    if v then
        for _, player in pairs(Players:GetPlayers()) do
            ESPVida_CreateHealthNumberESP(player)
        end
        Players.PlayerAdded:Connect(ESPVida_CreateHealthNumberESP)
    else
        ESPVida_DestroyAll()
    end
end)

-- Bot√£o Teleportador
AddButton(TabVisual, "Teleportador", function()
    local Players = game:GetService("Players")
    local UserInputService = game:GetService("UserInputService")
    local player = Players.LocalPlayer

    if game.CoreGui:FindFirstChild("TeleportUI") then
        game.CoreGui.TeleportUI:Destroy()
    end

    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "TeleportUI"
    screenGui.ResetOnSpawn = false
    screenGui.Parent = game:GetService("CoreGui")

    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(0, 300, 0, 150)
    Frame.Position = UDim2.new(0.5, -150, 0.5, -75)
    Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    Frame.BorderSizePixel = 0
    Frame.AnchorPoint = Vector2.new(0.5, 0.5)
    Frame.Parent = screenGui

    local corner = Instance.new("UICorner", Frame)
    corner.CornerRadius = UDim.new(0, 10)

    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 30)
    title.BackgroundTransparency = 1
    title.Text = "Teleportador"
    title.TextColor3 = Color3.new(1, 1, 1)
    title.Font = Enum.Font.GothamBold
    title.TextSize = 20
    title.Parent = Frame

    local closeButton = Instance.new("TextButton")
    closeButton.Size = UDim2.new(0, 30, 0, 30)
    closeButton.Position = UDim2.new(1, -35, 0, 0)
    closeButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
    closeButton.Text = "X"
    closeButton.TextColor3 = Color3.new(1, 1, 1)
    closeButton.Font = Enum.Font.GothamBold
    closeButton.TextSize = 20
    closeButton.Parent = Frame

    closeButton.MouseButton1Click:Connect(function()
        screenGui.Enabled = false
    end)

    local TextBox = Instance.new("TextBox")
    TextBox.Size = UDim2.new(0.9, 0, 0, 40)
    TextBox.Position = UDim2.new(0.05, 0, 0, 50)
    TextBox.PlaceholderText = "Digite o nome ou display name"
    TextBox.ClearTextOnFocus = false
    TextBox.TextColor3 = Color3.new(1, 1, 1)
    TextBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    TextBox.Font = Enum.Font.Gotham
    TextBox.TextSize = 18
    TextBox.Parent = Frame

    local corner2 = Instance.new("UICorner", TextBox)
    corner2.CornerRadius = UDim.new(0, 8)

    local teleportButton = Instance.new("TextButton")
    teleportButton.Size = UDim2.new(0.5, 0, 0, 40)
    teleportButton.Position = UDim2.new(0.25, 0, 0, 100)
    teleportButton.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
    teleportButton.Text = "Teleportar"
    teleportButton.TextColor3 = Color3.new(1, 1, 1)
    teleportButton.Font = Enum.Font.GothamBold
    teleportButton.TextSize = 20
    teleportButton.Parent = Frame

    local corner3 = Instance.new("UICorner", teleportButton)
    corner3.CornerRadius = UDim.new(0, 8)

    local function teleportToPlayer(nameOrDisplay)
        local targetPlayer = nil
        local nameLower = nameOrDisplay:lower()

        for _, plr in pairs(Players:GetPlayers()) do
            if plr.Name:lower() == nameLower or (plr.DisplayName and plr.DisplayName:lower() == nameLower) then
                targetPlayer = plr
                break
            end
        end

        if not targetPlayer then
            warn("[TeleportUI] Jogador n√£o encontrado: " .. nameOrDisplay)
            return false, "Jogador n√£o encontrado"
        end

        if not targetPlayer.Character or not targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
            warn("[TeleportUI] Personagem inv√°lido do jogador: " .. targetPlayer.Name)
            return false, "Personagem inv√°lido"
        end

        local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
        if hrp then
            local targetPos = targetPlayer.Character.HumanoidRootPart.Position
            local success, err = pcall(function()
                hrp.CFrame = CFrame.new(targetPos + Vector3.new(0, 3, 0))
            end)

            if success then
                return true, "Teleportado com sucesso para " .. targetPlayer.Name
            else
                warn("[TeleportUI] Erro ao teleportar: " .. tostring(err))
                return false, "Erro ao teleportar"
            end
        else
            return false, "Seu personagem n√£o est√° pronto"
        end
    end

    teleportButton.MouseButton1Click:Connect(function()
        local text = TextBox.Text
        if text == "" or not text then return end
        local success, msg = teleportToPlayer(text)
        if success then
            print("[TeleportUI] " .. msg)
        else
            warn("[TeleportUI] " .. msg)
        end
    end)

    local dragging, dragInput, dragStart, startPos

    local function update(input)
        local delta = input.Position - dragStart
        Frame.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end

    Frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = Frame.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    Frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
end)

-- Bot√£o Abrir Bau (AGORA NO FINAL)
AddButton(TabVisual, "Abrir Bau", function()
    local function abrirBau()
        local args = {"trasnferebau", "", "", 1}
        game:GetService("ReplicatedStorage").Modules.InvRemotes.InvRequest:InvokeServer(unpack(args))
    end
    abrirBau()
end)

--// Adicionar componentes na tab CONFIG

-- Anti Lag
AddButton(TabConfig, "Anti Lag", function()
    local RunService = game:GetService("RunService")
    local Lighting = game:GetService("Lighting")
    local Players = game:GetService("Players")
    local Workspace = game:GetService("Workspace")
    local Terrain = Workspace:FindFirstChildOfClass("Terrain")
    local LocalPlayer = Players.LocalPlayer

    if game.CoreGui:FindFirstChild("AntiLagUI") then
        game.CoreGui.AntiLagUI:Destroy()
    end

    for _, v in pairs(Workspace:GetDescendants()) do
        if v:IsA("Texture") or v:IsA("Decal") then
            v.Transparency = 1
        end
    end

    for _, v in ipairs(Workspace:GetDescendants()) do
        if v:IsA("ParticleEmitter") or v:IsA("Trail") or v:IsA("Smoke") or v:IsA("Fire") or v:IsA("Beam") or v:IsA("Explosion") then
            v.Enabled = false
        end
    end

    Lighting.GlobalShadows = false
    Lighting.Brightness = 0
    Lighting.EnvironmentDiffuseScale = 0
    Lighting.EnvironmentSpecularScale = 0
    Lighting.OutdoorAmbient = Color3.new(0.5, 0.5, 0.5)
    Lighting.FogEnd = 999999
    Lighting.ClockTime = 12
    Lighting.ShadowSoftness = 0
    Lighting.ExposureCompensation = 0

    for _, obj in ipairs(Lighting:GetChildren()) do
        if obj:IsA("BloomEffect") or obj:IsA("SunRaysEffect") or obj:IsA("ColorCorrectionEffect") or obj:IsA("DepthOfFieldEffect") or obj:IsA("BlurEffect") then
            obj.Enabled = false
        end
    end

    if Terrain then
        Terrain.WaterWaveSize = 0
        Terrain.WaterWaveSpeed = 0
        Terrain.WaterTransparency = 1
        Terrain.WaterReflectance = 0
    end

    for _, sound in ipairs(Workspace:GetDescendants()) do
        if sound:IsA("Sound") then
            sound.Playing = false
            sound.Volume = 0
        end
    end

    pcall(function()
        settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
        settings().Rendering.TextureQuality = Enum.TextureQuality.Low
        settings().Rendering.MeshPartDetailLevel = Enum.MeshPartDetailLevel.Low
        settings().Rendering.EditQualityLevel = Enum.QualityLevel.Level01
        settings().Rendering.GrassDetail = Enum.GrassDetailLevel.Low
        settings().Rendering.ShadowSoftness = 0
    end)

    Workspace.StreamingEnabled = true
    Workspace.StreamingMinRadius = 40
    Workspace.StreamingTargetRadius = 80
    Workspace.InterpolationThrottling = Enum.InterpolationThrottlingMode.Enabled

    for _, obj in ipairs(Workspace:GetDescendants()) do
        if obj:IsA("Script") and not obj:IsDescendantOf(LocalPlayer.Character) then
            pcall(function() obj.Disabled = true end)
        end
    end

    task.spawn(function()
        while task.wait(5) do
            collectgarbage("collect")
        end
    end)

    pcall(function()
        settings().Physics.AllowSleep = true
        settings().Physics.ThrottleAdjustTime = 10
        settings().Physics.PhysicsEnvironmentalThrottle = Enum.EnviromentalPhysicsThrottle.Always
    end)

    if setfpscap then
        setfpscap(60)
    end

    for _, part in ipairs(Workspace:GetDescendants()) do
        if part:IsA("BasePart") then
            part.Material = Enum.Material.Plastic
            part.Reflectance = 0
        end
    end

    local function optimizeChar(char)
        for _, v in ipairs(char:GetDescendants()) do
            if v:IsA("Accessory") or v:IsA("ShirtGraphic") or v:IsA("Shirt") or v:IsA("Pants") or v:IsA("CharacterMesh") then
                pcall(function() v:Destroy() end)
            end
        end
    end
    optimizeChar(LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait())
    LocalPlayer.CharacterAdded:Connect(optimizeChar)

    local gui = Instance.new("ScreenGui", game.CoreGui)
    gui.Name = "AntiLagUI"

    local frame = Instance.new("Frame", gui)
    frame.Size = UDim2.new(0, 220, 0, 50)
    frame.Position = UDim2.new(0.5, -110, 0, 20)
    frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    frame.BackgroundTransparency = 0.25
    frame.BorderSizePixel = 0
    frame.Active = true
    frame.Draggable = true
    Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 8)

    local label = Instance.new("TextLabel", frame)
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = "‚öôÔ∏è Anti-Lag Supremo Ativado (60+ FPS)"
    label.TextColor3 = Color3.new(1, 1, 1)
    label.TextSize = 16
    label.Font = Enum.Font.GothamBold

    local lastCheck = tick()
    RunService.RenderStepped:Connect(function(dt)
        if tick() - lastCheck > 1 then
            lastCheck = tick()
            if setfpscap then
                setfpscap(60)
            end
        end
    end)

    print("‚úÖ Anti-Lag Supremo ativado com sucesso! FPS estabilizado e texturas removidas.")
end)

-- Mostrar FPS/Ping
AddToggle(TabConfig, "Mostrar FPS/Ping", function(v)
    MostrarFPSPingAtivo = v
    if v then
        iniciarFPSPingUI()
    else
        if FPSPingUI then
            FPSPingUI:Destroy()
            FPSPingUI = nil
        end
    end
end)

--// Arrastar Menu
local dragging, dragInput, dragStart, startPos
TopBar.InputBegan:Connect(function(input)
    if input.UserInputType==Enum.UserInputType.MouseButton1 then
        dragging=true
        dragStart=input.Position
        startPos=MainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState==Enum.UserInputState.End then dragging=false end
        end)
    end
end)
TopBar.InputChanged:Connect(function(input)
    if input.UserInputType==Enum.UserInputType.MouseMovement then dragInput=input end
end)
UserInputService.InputChanged:Connect(function(input)
    if input==dragInput and dragging then
        local delta=input.Position-dragStart
        MainFrame.Position=UDim2.new(startPos.X.Scale,startPos.X.Offset+delta.X,startPos.Y.Scale,startPos.Y.Offset+delta.Y)
    end
end)

--// Sistema adaptativo Mobile/PC para minimizar/reabrir
local isMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled

-- Ret√¢ngulo de reabrir (arrast√°vel)
local ReopenFrame = Instance.new("Frame")
ReopenFrame.Size = UDim2.new(0, 120, 0, 40)
ReopenFrame.Position = UDim2.new(1, -140, 0, 20)
ReopenFrame.BackgroundColor3 = Color3.fromRGB(50, 150, 250)
ReopenFrame.Visible = false
ReopenFrame.Parent = ScreenGui
Instance.new("UICorner", ReopenFrame).CornerRadius = UDim.new(0, 10)

local ReopenText = Instance.new("TextLabel")
ReopenText.Size = UDim2.new(1, 0, 1, 0)
ReopenText.Text = "üëç Reabrir menu"
ReopenText.TextColor3 = Color3.fromRGB(255, 255, 255)
ReopenText.BackgroundTransparency = 1
ReopenText.Font = Enum.Font.GothamBold
ReopenText.TextSize = 16
ReopenText.Parent = ReopenFrame

if isMobile then
    MinBtn.MouseButton1Click:Connect(function()
        MainFrame.Visible = false
        ReopenFrame.Visible = true
    end)
else
    local minimized = false

    local function toggleMenu()
        minimized = not minimized
        MainFrame.Visible = not minimized
        if ReopenFrame then
            ReopenFrame.Visible = false
        end
    end

    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if not gameProcessed and input.KeyCode == Enum.KeyCode.K then
            toggleMenu()
        end
    end)
end

--// Controle de arraste/clique para ret√¢ngulo mobile
local draggingReopen = false
local dragStart, startPos
local moved = false

local function updateDrag(input)
	local delta = input.Position - dragStart
	ReopenFrame.Position = UDim2.new(
		startPos.X.Scale, startPos.X.Offset + delta.X,
		startPos.Y.Scale, startPos.Y.Offset + delta.Y
	)
	if math.abs(delta.X) > 3 or math.abs(delta.Y) > 3 then
		moved = true
	end
end

ReopenFrame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		draggingReopen = true
		dragStart = input.Position
		startPos = ReopenFrame.Position
		moved = false
	end
end)

ReopenFrame.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		draggingReopen = false
		if not moved then
			MainFrame.Visible = true
			ReopenFrame.Visible = false
		end
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if draggingReopen and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
		updateDrag(input)
	end
end)

MinBtn.MouseButton1Click:Connect(function()
	MainFrame.Visible = false
	ReopenFrame.Visible = true
end)
